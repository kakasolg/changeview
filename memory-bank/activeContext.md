# Active Context - 현재 작업 상황 (2025-06-29 업데이트)

## 🎯 현재 진행 중인 작업

### 현재 상태: 🃏 플래시카드 학습 시스템 (임시 운영 중)
**배경**: 원래 8면체 주사위 시스템 개발 중 기술적 문제로 인해 임시로 플래시카드 방식으로 변경
**목표**: 기술적 문제 해결 후 원래 8면체 주사위 시스템으로 복귀 예정

## 🎲 프로젝트 히스토리 및 기술적 이슈

### 원래 계획: 8면체 주사위 64괘 선택 시스템 (95% 완성 후 중단)
**혁신적 아이디어**: 기존 텍스트 입력 방식에서 → 직관적 3D 주사위 인터랙션으로 진화
- **수학적 완벽성**: 8면체 주사위 2개 (상괘 × 하괘) = 64가지 조합 완벽 구현
- **철학적 정합성**: 주역 원리에 부합하는 능동적 괘 선택 방식
- **3D 시스템 완성**: Three.js 기반 애니메이션, 사용자 인터랙션, 64괘 계산 로직

### ⚠️ 발생한 기술적 문제
**핵심 이슈**: 팔괘 상징(☰☱☲☳☴☵☶☷)을 8면체 주사위 면에 표시하는 문제
- **문제 상세**: Three.js 8면체 지오메트리와 다중 재료 배열 호환성 이슈
- **시도한 방법들**:
  - Canvas 텍스처 + 다중 재료 배열 → 실패
  - UV 매핑 방식 → 복잡성으로 보류
  - 3D 텍스트 생성 → 미완성
- **현재 상태**: 단일 색상 주사위만 표시됨 (파란색/빨간색)

### 🃏 임시 해결책: 플래시카드 시스템 구현
**결정 배경**: 주사위 기술적 문제 해결 대기 중 실용적 대안 필요
- **구현 방식**: 카드 뒤집기 (앞면: 문제, 뒷면: 답)
- **핵심 기능**: 스페이스 반복 학습법 (again/soon/later/mastered)
- **현재 상태**: **100% 완성, 완전 동작 중** ✅

## 🎯 현재 운영 중인 시스템

### ✅ 완벽하게 동작하는 플래시카드 학습 시스템
**URL**: http://localhost:3000
**주요 기능**:
- **64괘 플래시카드**: MongoDB에서 실제 괘 데이터 연동
- **카드 뒤집기**: 클릭으로 앞면(문제) ↔ 뒷면(답) 전환
- **학습 평가**: again🐣, soon🐥, later🦉, mastered🧠
- **메모 시스템**: 사용자별 괘 관련 메모 저장/조회
- **진도 관리**: 개별 괘별 학습 난이도 추적
- **찰리 멍거 정신 모델**: 여전히 활용 중 (예: 사전부검)

### 🗃️ 완성된 데이터 시스템
- **MongoDB**: 전체 64괘 데이터 완벽 구축
- **API 시스템**: CRUD 완전 구현
- **메모 DB**: 사용자별 학습 노트 관리
- **진도 DB**: 스페이스 반복 학습 데이터

### 🎨 사용자 경험
- **직관적 인터페이스**: 카드 게임처럼 쉬운 조작
- **학습 효과**: 스페이스 반복으로 기억 정착 최적화
- **개인화**: 개별 학습 패턴 추적 및 맞춤형 복습

## 📁 프로젝트 파일 구조 현황

### 현재 메인 시스템
- `src/app/page.tsx` = **플래시카드 메인 시스템** (운영 중)
- `src/app/api/flash-card/` = 학습 진도 관리 API
- `src/app/api/test/user-memo-db/` = 사용자 메모 시스템

### 대기 중인 시스템들
- `src/app/dice-test/page.tsx` = **8면체 주사위 시스템** (95% 완성, 기술적 문제로 보류)
- `src/app/page_old_hexagram_input.tsx` = **AI 통찰 플랫폼** (백업용)
- `src/app/components/` = AI 플랫폼용 컴포넌트들 (HexagramInput, AnalysisTabs 등)

### 확장 시스템
- `src/app/memorize/` = **범용 암기장 시스템** (완성)

## 🔮 향후 계획 및 로드맵

### 🥇 Phase 1: 기술적 문제 해결 (최우선)
**목표**: 8면체 주사위에 팔괘 상징 표시 완성
**해결 방안 후보들**:
1. **단일 텍스처 UV 매핑**: 하나의 텍스처에 8개 상징 배치, UV로 분할
2. **3D 텍스트 생성**: TextGeometry로 상징을 3D로 만들어 각 면에 부착
3. **커스텀 8면체 제작**: 8개 평면을 조합해 각각 다른 텍스처 적용
4. **대안 라이브러리**: Three.js 외 다른 3D 라이브러리 검토

### 🥈 Phase 2: 원래 비전 복구
**완료 조건**:
- 팔괘 상징이 주사위 면에 정확히 표시
- 사용자가 주사위를 굴리고 정지시켜 괘 선택
- MongoDB + Gemini API 연동으로 해석 생성
- 메인 페이지에 적용

### 🥉 Phase 3: 고급 기능 통합
**확장 계획**:
- 플래시카드 + 주사위 선택 옵션 제공
- AI 통찰 플랫폼 기능 통합
- Mental Models PDF 시스템 (찰리 멍거 격자틀 완성)

## 🛠️ 현재 기술적 도전과제

### 핵심 이슈: Three.js 8면체 팔괘 표시
**문제 상세**:
```javascript
// 현재 동작하는 코드 (단일 재료)
const dice1Material = new THREE.MeshLambertMaterial({ color: 0x3b82f6 });
dice1 = new THREE.Mesh(octahedronGeometry, dice1Material);

// 시도했지만 실패한 코드 (다중 재료)
const dice1Materials = trigrams.map(symbol => 
  new THREE.MeshLambertMaterial({ 
    map: createTrigramTexture(symbol, '#3b82f6')
  })
);
// → 8면체와 호환성 문제
```

**해결 필요사항**:
- 8면체의 각 면에 개별 텍스처/재료 적용
- 팔괘 상징의 명확한 가독성 확보
- 회전 시에도 왜곡 없는 표시

## 📊 현재 시스템 성숙도

### ✅ 완전 동작 (100%)
- 플래시카드 학습 시스템
- MongoDB 64괘 데이터베이스
- 사용자 메모 및 진도 관리
- 범용 암기장 시스템

### ⚠️ 기술적 이슈로 대기 (95%)
- 8면체 주사위 3D 시스템
- 팔괘 상징 표시 기능

### 📋 백업/확장 (90%)
- AI 통찰 플랫폼 (page_old_hexagram_input.tsx)
- Function Calling 시스템

## 🎯 다음 즉시 작업 (기술적 문제 해결)

### Option A: UV 매핑 방식 시도
1. 8개 팔괘 상징을 하나의 텍스처에 배치
2. UV 좌표로 각 면에 맞는 영역 매핑
3. 8면체 지오메트리 UV 좌표 수정

### Option B: 3D 텍스트 방식 시도
1. TextGeometry로 각 팔괘 상징을 3D 텍스트로 생성
2. 8면체 각 면의 중심에 부착
3. 적절한 크기와 위치 조정

### Option C: 대안 라이브러리 검토
1. Babylon.js, A-Frame 등 다른 3D 라이브러리 조사
2. 8면체 + 다중 텍스처 지원 확인
3. 마이그레이션 비용 대비 효과 분석

## 🔄 현재 작업 우선순위

1. **🥇 최우선**: 8면체 팔괘 표시 기술적 문제 해결
2. **🥈 중간**: 현재 플래시카드 시스템 유지 및 소폭 개선
3. **🥉 낮음**: AI 통찰 플랫폼 복구 및 통합

**결론**: 현재는 완벽하게 동작하는 플래시카드 시스템으로 서비스하면서, 8면체 주사위의 기술적 문제 해결에 집중하는 것이 최적의 전략입니다.

---

## 🆘 알려진 이슈 및 해결 대기 사항

### 기술적 이슈
- **Three.js 8면체 + 팔괘 상징 표시** (핵심 문제)
- Function Calling A-2 세트 연속 호출 미완성 (부차적 문제)

### 시스템 불일치
- Memory Bank vs 실제 프로젝트 차이 (본 업데이트로 해결됨)
- 여러 실험 프로젝트가 한 폴더에 공존

**최종 목표**: 기술적 문제 해결 후 혁신적인 8면체 주사위 64괘 선택 시스템 완성 🎲✨